<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SnapAim</title>

  <!-- Ubuntu font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;500;700;800&display=swap" rel="stylesheet">

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: "Ubuntu", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    html, body {
      height: 100%;
      width: 100%;
      overflow: hidden;
      background: #ffffff;
    }

    /* ========= CANVASES ========= */
    #bg, #c {
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      display: block;
    }
    #bg { z-index: 0; }
    #c  { z-index: 1; }

    /* ========= MENU ========= */
    :root {
      --menuW: min(640px, calc(100vw - 120px)); /* Diep-sized */
      --uiRadius: 6px;
      --outline: rgba(0,0,0,0.92);
      --outlineSize: 1.5px;
    }

    #menu {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2;
    }

    #menuInner {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 14px;
    }

    /* Username input */
    #nameInput {
      width: var(--menuW);
      height: 66px;
      background: #ffffff;
      color: #000000;
      border: 2px solid #b0b0b0;
      border-radius: var(--uiRadius);
      outline: none;
      font-size: 22px;
      font-weight: 600;
      text-align: center;
    }

    #nameInput::placeholder {
      color: #7a7a7a;
      font-weight: 500;
    }

    /* Outlined text (Diep-style) */
    .btnOutlinedText {
      color: rgba(255,255,255,0.98);
      text-shadow:
        var(--outlineSize) 0 var(--outline),
        calc(var(--outlineSize) * -1) 0 var(--outline),
        0 var(--outlineSize) var(--outline),
        0 calc(var(--outlineSize) * -1) var(--outline),
        calc(var(--outlineSize) * 0.9) calc(var(--outlineSize) * 0.9) var(--outline),
        calc(var(--outlineSize) * -0.9) calc(var(--outlineSize) * 0.9) var(--outline),
        calc(var(--outlineSize) * 0.9) calc(var(--outlineSize) * -0.9) var(--outline),
        calc(var(--outlineSize) * -0.9) calc(var(--outlineSize) * -0.9) var(--outline);
    }

    /* Play button — custom red-box size */
    #playBtn {
      width: 320px;
      height: 48px;
      margin-top: 22px;
      align-self: center;
      border-radius: var(--uiRadius);
      border: 0.5px solid rgba(0,0,0,0.18);
      cursor: pointer;
      user-select: none;
      background: linear-gradient(
        to bottom,
        #b9b9b9 0%,
        #b9b9b9 88%,
        #7c7c7c 88%,
        #7c7c7c 100%
      );
      font-size: 22px;
      font-weight: 800;
      letter-spacing: 0.3px;
    }

    #playBtn:active {
      transform: translateY(1px);
      filter: brightness(0.98);
    }

    /* Tutorial button — same gap as name->play, same width as play, green */
    #tutorialBtn {
      width: 320px;
      height: 30px;
      margin-top: 22px;
      align-self: center;
      border-radius: var(--uiRadius);
      border: 0.5px solid rgba(0,0,0,0.18);
      cursor: pointer;
      user-select: none;
      background: linear-gradient(
        to bottom,
        #7fe27f 0%,
        #7fe27f 88%,
        #4fbf4f 88%,
        #4fbf4f 100%
      );
      font-size: 16px;
      font-weight: 800;
      letter-spacing: 0.25px;
    }

    #tutorialBtn:active {
      transform: translateY(1px);
      filter: brightness(0.98);
    }

    /* ========= HUD (IN-GAME, SQUARE) ========= */
    #hudBottom {
      position: fixed;
      left: 50%;
      bottom: 28px;
      transform: translateX(-50%);
      width: min(860px, calc(100vw - 48px));
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      pointer-events: none;
      z-index: 3;
    }

    #hudName {
      width: 100%;
      text-align: center;
      font-weight: 700;
      font-size: 18px;
      color: rgba(0,0,0,0.85);
    }

    #hpBarOuter, #speedBarOuter {
      position: relative;
      width: 100%;
      height: 18px;
      border-radius: 0;
      overflow: hidden;
      background: rgba(0,0,0,0.08);
      border: 1px solid rgba(0,0,0,0.12);
    }

    #hpBarInner {
      height: 100%;
      width: 100%;
      background: #3ddc84;
    }

    #speedBarInner {
      height: 100%;
      width: 0%;
      background: hsl(60, 95%, 55%);
    }

    #hudHpText, #hudSpeedText {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 13px;
      color: rgba(0,0,0,0.85);
      user-select: none;
      z-index: 2;
    }

    /* ========= DEATH SCREEN ========= */
    #deathScreen {
      position: fixed;
      inset: 0;
      z-index: 4;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.35);
    }

    #deathCard {
      width: min(520px, calc(100vw - 80px));
      padding: 18px;
      background: rgba(255,255,255,0.92);
      border: 1px solid rgba(0,0,0,0.18);
      border-radius: var(--uiRadius);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    #deathSmall {
      font-size: 18px;
      font-weight: 700;
      color: rgba(0,0,0,0.72);
    }

    #deathBig {
      font-size: 34px;
      font-weight: 800;
      color: rgba(0,0,0,0.9);
      margin-top: -6px;
    }

    #continueBtn {
      width: 160px;
      height: 40px;
      border-radius: var(--uiRadius);
      border: 0.5px solid rgba(0,0,0,0.18);
      background: linear-gradient(
        to bottom,
        #cfcfcf 0%,
        #cfcfcf 88%,
        #8c8c8c 88%,
        #8c8c8c 100%
      );
      font-size: 16px;
      font-weight: 800;
      cursor: pointer;
    }

    /* ========= TUTORIAL OVERLAY ========= */
    #tutorialScreen {
      position: fixed;
      inset: 0;
      z-index: 5; /* above menu + HUD + death */
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.35);
    }

    #tutorialPanel {
      width: calc(100vw - 80px);
      height: calc(100vh - 80px);
      max-width: 1200px;
      max-height: 800px;
      background: rgba(255,255,255,0.96);
      border: 1px solid rgba(0,0,0,0.18);
      border-radius: var(--uiRadius);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    #tutorialHeader {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 16px;
      border-bottom: 1px solid rgba(0,0,0,0.12);
      background: rgba(0,0,0,0.03);
    }

    #tutorialTitle {
      font-size: 20px;
      font-weight: 800;
      color: rgba(0,0,0,0.88);
    }

    #tutorialClose {
      width: 44px;
      height: 38px;
      border-radius: var(--uiRadius);
      border: 0.5px solid rgba(0,0,0,0.18);
      cursor: pointer;
      user-select: none;
      background: linear-gradient(
        to bottom,
        #cfcfcf 0%,
        #cfcfcf 88%,
        #8c8c8c 88%,
        #8c8c8c 100%
      );
      font-size: 18px;
      font-weight: 900;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #tutorialBody {
      padding: 18px;
      overflow: auto;
    }

    #tutorialText {
      font-size: 20px;
      font-weight: 600;
      color: rgba(0,0,0,0.88);
      line-height: 1.55;
      white-space: pre-wrap;
    }
  </style>
</head>

<body>
  <canvas id="bg"></canvas>
  <canvas id="c"></canvas>

  <!-- MENU -->
  <div id="menu">
    <div id="menuInner">
      <input id="nameInput" maxlength="18" placeholder="Good luck, ... (PUT USERNAME HERE)" />
      <button id="playBtn" class="btnOutlinedText">Play!</button>
      <button id="tutorialBtn" class="btnOutlinedText">Tutorial</button>
    </div>
  </div>

  <!-- TUTORIAL OVERLAY -->
  <div id="tutorialScreen">
    <div id="tutorialPanel">
      <div id="tutorialHeader">
        <div id="tutorialTitle">Tutorial</div>
        <button id="tutorialClose">✕</button>
      </div>
      <div id="tutorialBody">
        <div id="tutorialText">The faster you go, the more damage you can do. Click to apply damage at your speed, if you are moving at 1000, and you click on someone while moving at 1000, you deal 1000 damage. Do not go over the speed limit, or you die to speed. Your mouse is your character.</div>
      </div>
    </div>
  </div>

  <!-- HUD -->
  <div id="hudBottom">
    <div id="hudName">Loading...</div>
    <div id="hpBarOuter">
      <div id="hpBarInner"></div>
      <div id="hudHpText">100,000 / 100,000 HP</div>
    </div>
    <div id="speedBarOuter">
      <div id="speedBarInner"></div>
      <div id="hudSpeedText">Speed: 0/2000</div>
    </div>
  </div>

  <!-- DEATH SCREEN -->
  <div id="deathScreen">
    <div id="deathCard">
      <div id="deathSmall">You were killed by</div>
      <div id="deathBig">Unknown</div>
      <button id="continueBtn" class="btnOutlinedText">Continue</button>
    </div>
  </div>

  <!-- Background grid + Tutorial wiring -->
  <script>
    // ---------- Tutorial overlay wiring ----------
    const tutorialBtn = document.getElementById("tutorialBtn");
    const tutorialScreen = document.getElementById("tutorialScreen");
    const tutorialClose = document.getElementById("tutorialClose");
    const tutorialPanel = document.getElementById("tutorialPanel");

    function openTutorial() {
      tutorialScreen.style.display = "flex";
    }
    function closeTutorial() {
      tutorialScreen.style.display = "none";
    }

    tutorialBtn.addEventListener("click", openTutorial);
    tutorialClose.addEventListener("click", closeTutorial);

    // click outside the panel closes it
    tutorialScreen.addEventListener("click", (e) => {
      if (e.target === tutorialScreen) closeTutorial();
    });

    // ESC closes it
    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && tutorialScreen.style.display === "flex") {
        closeTutorial();
      }
    });

    // ---------- Background grid ----------
    const bg = document.getElementById("bg");
    const bctx = bg.getContext("2d");

    function resizeBg() {
      bg.width = window.innerWidth;
      bg.height = window.innerHeight;
    }
    window.addEventListener("resize", resizeBg);
    resizeBg();

    let ox = 0, oy = 0;
    const spacing = 40;
    const speed = 0.22;

    function drawGrid() {
      bctx.clearRect(0, 0, bg.width, bg.height);
      bctx.fillStyle = "#ffffff";
      bctx.fillRect(0, 0, bg.width, bg.height);
      bctx.strokeStyle = "#e2e2e2";
      bctx.lineWidth = 1;

      ox -= speed;
      oy -= speed;
      if (ox <= -spacing) ox += spacing;
      if (oy <= -spacing) oy += spacing;

      for (let x = ox; x < bg.width; x += spacing) {
        bctx.beginPath();
        bctx.moveTo(x, 0);
        bctx.lineTo(x, bg.height);
        bctx.stroke();
      }
      for (let y = oy; y < bg.height; y += spacing) {
        bctx.beginPath();
        bctx.moveTo(0, y);
        bctx.lineTo(bg.width, y);
        bctx.stroke();
      }

      requestAnimationFrame(drawGrid);
    }
    drawGrid();
  </script>

  <script src="./main.js" defer></script>
</body>
</html>
